<!DOCTYPE html>
<html lang="en">
  <head>
    <title>jsTracker</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
	
	<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
      <link href="bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
      <link href="http://bootswatch.com/slate/bootstrap.min.css" rel="stylesheet" media="screen">

    <link href="http://bootswatch.com/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://bootswatch.com/css/bootswatch.css" rel="stylesheet">

      <link href="css/jquery.pnotify.default.css" rel="stylesheet">

    <style>
        #player {
            overflow:auto;
            background-color: rgba(0,0,0,0.3);
            border: 1px solid rgba(0,0,0,0.5);
            box-shadow: 0 0 20px rgba(0,0,0,0.3),inset 0 0 30px rgba(0,0,0,0.9);

            height:400px;
            position:relative;
            font-family:monospace;
            font-size:10px;
            height: 400px;
            text-transform: uppercase;
        }
        .track{ margin:150px 0; display:none; margin-bottom: 239px; }
        .row { clear:both; margin-left: 10px; }
        .note { width:80px; margin: 0px 5px; color:#80ff80; }
        .note, .tone, .instrument, .vol, .fx, .fxp, .num {
            float:left;
            margin-left:2px;
            font-weight:bold;
            font-size:11px;
            line-height: 12px;
        }
        .instrument {
            color:#80e0ff;
        }
        .vol {
            color:#80ff80;
            display: none;
        }
        .num {
            margin-right: 5px;
        }
        .num.hl {
            color:#ffff80;
        }
        .fx {
            color:#ff80e0;
        }
        .fxp  {
            color:#ffe080;
        }
        .nonote {
            border: solid 1px;
            width: 19px;
            height: 7px;
            margin-top: 2px;
        }
        #currentRow {
            position:relative;
        }
        #currentRow #inner {
            border:1px solid rgba(255,255,255,0.5);
            background-color: rgba(255,255,255,0.1);
            height:13px;
            width:919px;
            opacity:0.6;
            position:absolute;
            top:-252px;
            margin-left: 1px;
            border-left: none;
            border-right: none;
        }

        body { padding-top:80px; }
        .subhead > div:first-child { min-height: 140px; }
        .c0disabled .c0, .c1disabled .c1, .c2disabled .c2, .c3disabled .c3, .c4disabled .c4, .c5disabled .c5, .c6disabled .c6, .c7disabled .c7, .c8disabled .c8, .c9disabled .c9, .c10disabled .c10,
        .c11disabled .c11, .c12disabled .c12, .c13disabled .c13, .c14disabled .c14, .c15disabled .c15, .c16disabled .c16, .c17disabled .c17, .c18disabled .c18, .c19disabled .c19, .c20disabled .c20,
        .c21disabled .c21, .c22disabled .c22, .c23disabled .c23, .c24disabled .c24, .c25disabled .c25, .c26disabled .c26, .c27disabled .c27, .c28disabled .c28, .c29disabled .c29, .c30disabled .c30,
        .c30disabled .c30, .c31disabled .c31
        { opacity: 0.3; text-shadow: 0 0 5px; }
        .controls, .controls label {
            color: #7a8288;
            font-weight: bold;
            text-shadow: -1px -1px 0 rgba(0,0,0,0.3);
        }
        .controls label {
            display: inline-block;
            margin-right: 10px;
            margin-top: 0;
            margin-bottom: 0;
            line-height: 5px;
        }
        #info { text-align:center; height:21px; }
    </style>
  </head>
  <body>
	<div class="navbar navbar-fixed-top">
	  <div class="navbar-inner">
		<div class="container">
		  <ul class="nav">
			<li class="active"><a href="#">Home</a></li>
			<li><a href="#">Projects</a></li>
			<li><a href="#">Services</a></li>
			<li><a href="#">Downloads</a></li>
			<li><a href="#">About</a></li>
			<li><a href="#">Contact</a></li>
		  </ul>

            <button id="playpause" class="btn btn-success btn-small" style="display: none"><i class='icon-play'></i> Play</button>

        </div>
	  </div>
	</div><!-- /.navbar -->    

	<div class="container">
	
		<header class="jumbotron subhead" id="overview">
		  <div class="row">
			<div class="span6">
			  <h1>jsTracker</h1>
			  <p class="lead">yada yada yada?</p>
			</div>
			<div class="span6">
				<!-- hï¿½ger.. -->
			</div>
		  </div>
		</header>


        <div class="controls">
            <div id="mutes"></div>
            <div id="info"></div>
        </div>
        <div class="section" id="player">
        </div>
        <div id="currentRow"><div id="inner"></div></div>

        <div class="section" id="debug">
        </div>

    </div>
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="js/tracker.js"></script>
    <script src="js/jquery.pnotify.min.js"></script>
    <script>
        $(function(){
            window.t = new Tracker("#player");
            var songs = ['http://www.flossy.se/tracker/ba1.json','http://www.flossy.se/tracker/dreamoff.json','http://www.flossy.se/tracker/StateOfTheArt.json',
                'http://www.flossy.se/tracker/utmenu.json','http://www.flossy.se/tracker/aryx.json','http://www.flossy.se/tracker/robyn.json'];
            t.load(songs[3],function(d){
                function updateplaypause(playing) {
                    $("#playpause").html(playing ? "<i class='icon-pause'></i> Pause" : "<i class='icon-play'></i> Play")
                            .removeClass('btn-success').removeClass('btn-danger')
                            .addClass(playing ? 'btn-danger' : 'btn-success');
                }
                $("#playpause").show();
                $("#playpause").click(function(){ updateplaypause(t.togglePlay()); });
                $("#mutes").empty();

                window.song = t.getSong();

                t.onUpdate(function(pos, pat, speed,bpm){
                    $("#info").html('Position: ' + pos + ' Pattern:' + pat + ' Speed: ' + speed + ' Bpm:' + bpm);
                });

                for(var i=0; i<song.ChannelsCount; i++){
                    $("#mutes").append('<input id="mute'+i+'" type="checkbox" data-channel="' + i + '" class="mute" checked/> <label for="mute'+i+'">' + (i+1) + '</label>');
                }
            });

            $("#mutes").on("change",".mute", function(){
                t.mute(Number($(this).data("channel")),!$(this).is(":checked"));
            });
        });

        function dumpInstrument(song, i){
            var ins = song.Instruments[i], c = plotAudio(ins.WaveData, 650,300);
            $("#debug").empty().append(c);
            $("#debug").append("<strong>"+ extractFlags(ins.Samples[0].Flags) + "</strong>");
        }

    </script>
  </body>
</html>